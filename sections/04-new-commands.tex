\section{New or Enhanced PIV Commands}

This section introduces commands defined exclusively for the OSDP 2.3 Enhanced PIV profile.

\subsection{PIV Put Data (osdp\_PIVPUTDATA)}

The \texttt{osdp\_PIVPUTDATA} command instructs the PD to deliver an ISO~7816-4 \texttt{PUT DATA} operation to the credential. The ACU \textbf{SHALL} construct the payload as a complete BER-TLV object, including the desired outer tag (\texttt{0x7E} for the Discovery Object, \texttt{0x7F61} for a BIT Group Template, \texttt{0x5C}/\texttt{0x53} sequences for other data objects, and so on). The PD \textbf{SHALL} forward the payload to the credential using \texttt{CLA = 0x00}, \texttt{INS = 0xDB}, \texttt{P1 = 0x3F}, and \texttt{P2 = 0xFF}. If VCI secure messaging is established, the PD \textbf{SHALL} select the secure channel automatically and adjust the \texttt{CLA} accordingly. Chained APDUs \textbf{SHALL} be generated by the PD when the payload exceeds a single-card APDU.

\input{tables/osdp-pivputdata}

\paragraph{Responses} A successful write is acknowledged with \texttt{osdp\_ACK}. Failures \textbf{SHALL} use \texttt{osdp\_NAK} with one of the Enhanced PIV error codes defined in Subsection~\ref{sec:new-piv-error-codes}: \texttt{0x0A} when the function is not supported, \texttt{0x0B} when the PD lacks buffer space to stage the payload, \texttt{0x0C} when the credential has insufficient storage, or \texttt{0x0D} when security conditions on the credential are not met.
